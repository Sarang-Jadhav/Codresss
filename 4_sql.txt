CREATE TABLE Borrower(
  Roll_no NUMBER,
  Name VARCHAR2(30),
  DateofIssue DATE,
  NameofBook VARCHAR2(30),
  Status CHAR(1)
);

CREATE TABLE Fine(
  Roll_no NUMBER,
  Date DATE,
  Amt NUMBER
);

INSERT INTO Borrower VALUES(1,'Ajay',TO_DATE('01-SEP-2024','DD-MON-YYYY'),'DBMS','I');
INSERT INTO Borrower VALUES(2,'Raj',TO_DATE('10-AUG-2024','DD-MON-YYYY'),'OS','I');
/



SET SERVEROUTPUT ON;
/

DECLARE
    v_roll borrower.roll_no%TYPE := &roll;
    v_book borrower.nameofbook%TYPE := '&book';

    v_dateofissue DATE;
    v_status borrower.status%TYPE;
    v_days NUMBER;
    v_fine NUMBER := 0;

    ex_already_returned EXCEPTION;

BEGIN
    SELECT DateOfIssue, Status
    INTO v_dateofissue, v_status
    FROM Borrower
    WHERE roll_no = v_roll
      AND NameOfBook = v_book;

    IF v_status = 'R' THEN
         RAISE ex_already_returned;
    END IF;

    v_days := TRUNC(SYSDATE - v_dateofissue);

    IF v_days > 30 THEN
        v_fine := v_days * 50;
    ELSIF v_days >= 15 THEN
        v_fine := v_days * 5;
    ELSE
        v_fine := 0;
    END IF;

    UPDATE Borrower
    SET Status = 'R'
    WHERE roll_no = v_roll
      AND NameOfBook = v_book;

    IF v_fine > 0 THEN
        INSERT INTO Fine VALUES(v_roll, SYSDATE, v_fine);
    END IF;

    DBMS_OUTPUT.PUT_LINE('BOOK RETURN SUCCESSFUL');
    DBMS_OUTPUT.PUT_LINE('Days = '||v_days||'  Fine = '||v_fine);

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('Invalid Roll no or Book name');
    WHEN ex_already_returned THEN
        DBMS_OUTPUT.PUT_LINE('Book already returned earlier');
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error : '||SQLERRM);
END;
/




How to run
SET SERVEROUTPUT ON;


Then run block â†’ it will ask values: